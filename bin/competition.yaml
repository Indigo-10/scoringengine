---
# Purple Team Training Environment - Scoring Configuration
# Services: dc01, ftp, wkst1, ecommerce, squirrelmail, splunk
# Domain: ccso.local
# Default creds will be changed after initial deployment
#
# To regenerate: python3 scoreboard/generate_config.py > scoringengine/bin/competition.yaml

teams:
- name: WhiteTeam
  color: White
  users:
  - username: admin
    password: YourSecurePassword123!

- name: RedTeam
  color: Red
  users:
  - username: redteam
    password: YourSecurePassword123!

- name: BlueTeam
  color: Blue
  users:
  - username: blueteam
    password: YourSecurePassword123!
  services:

  # ═══════════════════════════════════════════════
  # DC01 - Active Directory / DNS (10.1.0.122)
  # ═══════════════════════════════════════════════

  # RDP Check disabled (freerdp3 adds build complexity)
  # - name: DC01-RDP
  #   check_name: RDPCheck
  #   host: 10.1.0.122
  #   port: 3389
  #   points: 100
  #   accounts:
  #   - username: Administrator
  #     password: YourSecurePassword123!
  #   environments:
  #   - matching_content: "SUCCESS$"

  - name: DC01-WinRM
    check_name: WinRMCheck
    host: 10.1.0.122
    port: 5985
    points: 100
    accounts:
    - username: Administrator
      password: YourSecurePassword123!
    environments:
    - matching_content: "SUCCESS"
      properties:
      - name: commands
        value: "ipconfig /all;whoami"

  - name: DC01-LDAP
    check_name: LDAPCheck
    host: 10.1.0.122
    port: 389
    points: 100
    accounts:
    - username: Administrator
      password: YourSecurePassword123!
    environments:
    - matching_content: "result: 0 Success"
      properties:
      - name: domain
        value: ccso.local
      - name: base_dn
        value: dc=ccso,dc=local

  - name: DC01-DNS
    check_name: DNSCheck
    host: 10.1.0.122
    port: 53
    points: 100
    environments:
    - matching_content: "status: NOERROR"
      properties:
      - name: qtype
        value: A
      - name: domain
        value: ccso.local
    - matching_content: "ANSWER SECTION"
      properties:
      - name: qtype
        value: A
      - name: domain
        value: dc01.ccso.local

  - name: DC01-SMB
    check_name: SMBCheck
    host: 10.1.0.122
    port: 445
    points: 100
    accounts:
    - username: Administrator
      password: YourSecurePassword123!
    environments:
    - matching_content: "^SUCCESS"
      properties:
      - name: remote_name
        value: ccso.local
      - name: share
        value: SYSVOL
      - name: file
        value: ccso.local
      - name: hash
        value: ""

  - name: DC01-ICMP
    check_name: ICMPCheck
    host: 10.1.0.122
    port: 0
    points: 50
    environments:
    - matching_content: "1 packets transmitted, 1 received"

  # ═══════════════════════════════════════════════
  # FTP - Windows 11 Pro Workstation (10.1.3.27)
  # ═══════════════════════════════════════════════

  # RDP Check disabled (freerdp3 adds build complexity)
  # - name: FTP-RDP
  #   check_name: RDPCheck
  #   host: 10.1.3.27
  #   port: 3389
  #   points: 100
  #   accounts:
  #   - username: Administrator
  #     password: YourSecurePassword123!
  #   environments:
  #   - matching_content: "SUCCESS$"

  - name: FTP-FTP
    check_name: FTPCheck
    host: 10.1.3.27
    port: 21
    points: 150
    accounts:
    - username: Administrator
      password: YourSecurePassword123!
    environments:
    - matching_content: "^SUCCESS"
      properties:
      - name: remotefilepath
        value: "/score_check.txt"
      - name: filecontents
        value: "scoring engine check file"

  - name: FTP-ICMP
    check_name: ICMPCheck
    host: 10.1.3.27
    port: 0
    points: 50
    environments:
    - matching_content: "1 packets transmitted, 1 received"

  # ═══════════════════════════════════════════════
  # WKST1 - Ubuntu Workstation (10.1.2.14)
  # ═══════════════════════════════════════════════

  - name: WKST1-SSH
    check_name: SSHCheck
    host: 10.1.2.14
    port: 22
    points: 150
    accounts:
    - username: ubuntu
      password: YourRootPassword123!
    environments:
    - matching_content: "ubuntu"
      properties:
      - name: commands
        value: "whoami"
    - matching_content: "home"
      properties:
      - name: commands
        value: "ls /home"

  - name: WKST1-ICMP
    check_name: ICMPCheck
    host: 10.1.2.14
    port: 0
    points: 50
    environments:
    - matching_content: "1 packets transmitted, 1 received"

  # ═══════════════════════════════════════════════
  # ECOMMERCE - WordPress / MySQL (10.1.1.90)
  # ═══════════════════════════════════════════════

  - name: Ecommerce-HTTP
    check_name: HTTPCheck
    host: 10.1.1.90
    port: 80
    points: 150
    environments:
    - matching_content: "WordPress"
      properties:
      - name: useragent
        value: "Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)"
      - name: vhost
        value: "10.1.1.90"
      - name: uri
        value: "/"
    - matching_content: "shop"
      properties:
      - name: useragent
        value: "Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)"
      - name: vhost
        value: "10.1.1.90"
      - name: uri
        value: "/shop/"

  - name: Ecommerce-SSH
    check_name: SSHCheck
    host: 10.1.1.90
    port: 22
    points: 100
    accounts:
    - username: ubuntu
      password: YourRootPassword123!
    environments:
    - matching_content: "ubuntu"
      properties:
      - name: commands
        value: "whoami"

  - name: Ecommerce-MySQL
    check_name: MYSQLCheck
    host: 10.1.1.90
    port: 3306
    points: 100
    accounts:
    - username: wordpress_user
      password: wordpress_password
    environments:
    - matching_content: "wp_"
      properties:
      - name: database
        value: wordpress
      - name: command
        value: "show tables;"

  - name: Ecommerce-ICMP
    check_name: ICMPCheck
    host: 10.1.1.90
    port: 0
    points: 50
    environments:
    - matching_content: "1 packets transmitted, 1 received"

  # ═══════════════════════════════════════════════
  # SQUIRRELMAIL - Mail Server (10.1.3.227)
  # ═══════════════════════════════════════════════

  - name: Mail-HTTP
    check_name: HTTPCheck
    host: 10.1.3.227
    port: 80
    points: 100
    environments:
    - matching_content: "SquirrelMail"
      properties:
      - name: useragent
        value: "Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)"
      - name: vhost
        value: "10.1.3.227"
      - name: uri
        value: "/src/login.php"

  - name: Mail-SMTP
    check_name: SMTPCheck
    host: 10.1.3.227
    port: 25
    points: 150
    accounts:
    - username: root@ccso.local
      password: YourRootPassword123!
    environments:
    - matching_content: "250"
      properties:
      - name: touser
        value: "root@ccso.local"
      - name: subject
        value: "Scoring Engine Check"
      - name: body
        value: "Service check from scoring engine"

  - name: Mail-SSH
    check_name: SSHCheck
    host: 10.1.3.227
    port: 22
    points: 100
    accounts:
    - username: fedora
      password: YourRootPassword123!
    environments:
    - matching_content: "fedora"
      properties:
      - name: commands
        value: "whoami"

  - name: Mail-ICMP
    check_name: ICMPCheck
    host: 10.1.3.227
    port: 0
    points: 50
    environments:
    - matching_content: "1 packets transmitted, 1 received"

  # ═══════════════════════════════════════════════
  # SPLUNK - SIEM (10.1.0.189)
  # ═══════════════════════════════════════════════

  - name: Splunk-HTTP
    check_name: HTTPCheck
    host: 10.1.0.189
    port: 8000
    points: 150
    environments:
    - matching_content: "Splunk"
      properties:
      - name: useragent
        value: "Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)"
      - name: vhost
        value: "10.1.0.189"
      - name: uri
        value: "/"

  - name: Splunk-SSH
    check_name: SSHCheck
    host: 10.1.0.189
    port: 22
    points: 100
    accounts:
    - username: oracle
      password: YourRootPassword123!
    environments:
    - matching_content: "oracle"
      properties:
      - name: commands
        value: "whoami"

  - name: Splunk-ICMP
    check_name: ICMPCheck
    host: 10.1.0.189
    port: 0
    points: 50
    environments:
    - matching_content: "1 packets transmitted, 1 received"

# Flags (placeholder - add CTF-style flags later)
flags: []
